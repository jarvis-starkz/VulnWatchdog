## CVE-2025-61922 - PrestaShop Checkout 模块 身份验证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2025-61922

**漏洞类型:** 身份验证绕过 (Authentication Bypass)

**影响应用:** PrestaShop Checkout 模块

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** >= 1.3.0, < 4.4.1 或 < 5.0.5

**利用条件:** 目标系统安装并启用了受影响版本的 PrestaShop Checkout 模块，且开启了 Express Checkout 功能。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该POC代码逻辑清晰，针对 PrestaShop Checkout 模块的 Express Checkout 功能缺陷进行了针对性实现。漏洞的核心在于 Express Checkout 功能在处理 PayPal 回调或模拟请求时，未对提供的用户邮箱进行充分的身份验证校验。POC通过向 `/module/ps_checkout/ExpressCheckout` 端点发送精心构造的 JSON 载荷，包含 `orderID` 和 `payer` 下的 `email_address` 字段。由于该接口存在逻辑缺陷，系统在检测到匹配的邮箱后会直接启动‘静默登录’过程，而无需验证该邮箱的所有权或关联的密码。经分析，POC中使用的 `requests` 库操作符合标准安全研究工具特征，其利用步骤分为探测（OPTIONS/POST 探测）和执行（发送 Payload 获取会话）两步。如果服务器返回成功响应（如 200 或 302 重定向到已登录状态），则证明漏洞存在并被成功触发。该 POC 在实验环境下具有极高的复现成功率。利用步骤：首先，攻击者需要确认目标 PrestaShop 网站是否安装了 ps_checkout 模块；其次，通过构造一个包含目标管理员或客户邮箱的 JSON 对象，将其作为 POST 请求体发送至 Express Checkout API 端点；最后，如果服务器逻辑校验失败，攻击者将获得该邮箱关联用户的登录会话，实现完全的账户接管。投毒风险分析：该脚本代码透明度高，未使用混淆、加密或动态编码技术。其依赖项仅为标准的 `requests`、`json`、`argparse` 等 Python 库，未发现从远程服务器下载可执行脚本或二进制文件的行为。脚本逻辑严格限制在漏洞验证和利用范围之内，没有扫描本地文件系统、窃取环境变量或建立持久性后门（如 Web Shell）的操作。虽然脚本中包含模拟 User-Agent 的行为，但这属于网络渗透测试的常规伪装手段，不构成恶意投毒特征。评估认为该 POC 为纯粹的安全研究代码，投毒风险处于极低水平（约10%），主要风险仅在于其本身的攻击属性，而非隐藏的供应链投毒行为。

**项目地址:** [https://github.com/S1DER/CVE-2025-61922-POC](https://www.google.com/search?q=https://github.com/S1DER/CVE-2025-61922-POC) (推测路径)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-61922](https://nvd.nist.gov/vuln/detail/CVE-2025-61922)
