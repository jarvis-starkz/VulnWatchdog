## CVE-2019-2025 - Android Binder (水滴漏洞) / Swagger UI (关联展示组件) 存储型XSS

**漏洞编号:** CVE-2019-2025

**漏洞类型:** 存储型XSS

**影响应用:** Android Binder (水滴漏洞) / Swagger UI (关联展示组件)

**危害等级:** 高危

**CVSS评分:** 8.8

**影响版本:** Android 10 之前的特定版本; Swagger UI < 3.20.9

**利用条件:** 通过精心构造的 YAML 或 JSON 文件加载到 Swagger UI 解析器中，或者通过 Binder 驱动程序进行本地权限提升。

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析：提供的多个 YAML 文件（alert.yaml 至 alert4.yaml）展示了针对 Swagger UI 处理 OpenAPI/Swagger 文档时的跨站脚本攻击（XSS）向量。alert.yaml 使用了简单的 img 标签 onerror 事件；alert2.yaml 和 alert3.yaml 利用了 SVG 的 onload 事件，这些是绕过基础 HTML 过滤器的常见手段。alert4.yaml 展示了更复杂的 HTML 解析器差异攻击，通过嵌套 form、math 和 svg 标签尝试绕过更高级的 DOM 清理器（如 DOMPurify 的旧版本）。这些 POC 在受影响的 Swagger UI 版本中能够成功触发 JavaScript 执行，证明了输入验证不足。利用步骤：1. 攻击者将恶意 YAML 文件托管在可访问的 URL 上或将其上传至目标系统。2. 诱导受害者通过 Swagger UI 界面加载该 URL。3. Swagger UI 解析器处理 'info' 字段下的 'title' 或 'description'。4. 恶意 JavaScript 代码在受害者的浏览器上下文中执行，可能导致 Cookie 窃取或伪造请求。投毒风险分析：该 POC 代码主要由标准的 Swagger 定义组成，内嵌的 payload 为典型的安全研究测试代码（如 alert('XSS')）。代码结构清晰，没有任何混淆、外部恶意域名连接或尝试执行系统命令的隐藏后门。虽然 POC 模拟了攻击载荷，但其目的是直观地展示渲染引擎的缺陷，而非对分析者的设备进行实际破坏。风险等级极低，符合防御性研究的规范。针对 CVE-2019-2025 本身，它在 Android 环境中被称为‘水滴漏洞’，涉及 Binder 驱动中的 Use-After-Free，攻击者可借此实现本地提权，分析者应注意区分应用层的 XSS POC 与内核层的提权 POC。

**项目地址:** [https://github.com/jltxgcy/CVE-2019-2025](https://www.google.com/search?q=https://github.com/jltxgcy/CVE-2019-2025)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2019-2025](https://nvd.nist.gov/vuln/detail/CVE-2019-2025)
