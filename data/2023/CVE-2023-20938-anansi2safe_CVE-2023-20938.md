## CVE-2023-20938 - Android OS (Binder Driver) 本地权限提升

**漏洞编号:** CVE-2023-20938

**漏洞类型:** 本地权限提升

**影响应用:** Android OS (Binder Driver)

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Android 11, 12, 12L, 13

**利用条件:** 具有本地普通用户执行权限，能够访问Binder驱动（/dev/binder 或 /dev/hwbinder）

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：本漏洞存在于Android Binder驱动程序中，属于典型的释放后使用（UAF）或内存破坏漏洞。CVE-2023-20938源于Binder在处理特定事务（transaction）过程中的逻辑缺陷，允许本地恶意应用程序利用竞争条件或不当的引用计数管理来实现内核空间的任意读写。通过分析提供的POC代码，该项目结构完整，包含了Makefile构建脚本、跨平台编译配置（aarch64-linux-gnu-gcc）以及核心利用模块（src/main.c, binder.c等）。代码中明确指定了对/dev/hwbinder的调用，这是Android硬件抽象层常用的通信接口。该POC采用静态链接方式编译，确保了在目标Android设备上的独立运行能力。利用步骤如下：首先，通过aarch64交叉编译器编译生成名为exploit的可执行文件；其次，通过ADB（Android Debug Bridge）将二进制文件推送到受害设备的/data/local/tmp目录下；最后，运行run.sh脚本启动利用程序。利用程序会通过binder_call发起精心构造的IPC请求，触发内核缓冲区的不当操作，最终通过篡改内核凭证结构体（cred struct）来提升当前进程至root权限。由于Binder是Android最核心的进程间通信机制，其漏洞往往具备极高的稳定性，该POC针对内核底层进行交互，逻辑合理且目标明确，具有极高的实战价值。投毒风险分析：该POC项目的代码结构清晰，主要基于Android开源项目的原始Binder定义进行扩展。在对Makefile、run.sh以及头文件进行静态审查后发现，其主要逻辑集中在漏洞触发和权限提升上，并未发现明显的恶意混淆或外部C2（控制端）连接行为。代码中使用了标准的Android底层系统调用和IOCTL操作，不包含非必要的二进制加密。然而，风险点在于该项目使用了预设的shell自动化脚本（run.sh），且编译目标是针对特定架构的静态文件，这常见于恶意攻击工具包中。15%的投毒风险主要源于此类利用代码在分发过程中可能被二次打包，虽然目前的源代码版本呈现出研究性质，但由于其能够获取root权限，防御者在使用时仍需在沙箱环境中进行交叉验证，防止在编译阶段触发针对开发机的恶意代码注入。总体而言，该代码是一个高质量的防御性研究样本，但其深度涉及内核操作，必须在受控环境中进行测试。

**项目地址:** [https://nvd.nist.gov/vuln/detail/CVE-2023-20938](https://nvd.nist.gov/vuln/detail/CVE-2023-20938)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2023-20938](https://nvd.nist.gov/vuln/detail/CVE-2023-20938)
